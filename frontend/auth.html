<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Login | Daily Code Snippet</title>

  <!-- ðŸ” HARD AUTH GUARD (runs BEFORE UI renders) -->
  <script>
    const token = localStorage.getItem("token");
    const isGuest = localStorage.getItem("isGuest");

    if (token || isGuest) {
      // Prevent auth page from ever flashing
      window.location.replace("index.html");
    }
  </script>

  <link rel="stylesheet" href="./style.css" />
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- ðŸ§  Prevent flash of unstyled / old UI -->
  <style>
    body { visibility: hidden; }
  </style>
</head>

<body class="min-h-screen bg-slate-900 text-white flex items-center justify-center px-4">

  <!-- AUTH CARD -->
  <div class="w-full max-w-sm bg-slate-800 p-6 rounded-xl space-y-4 shadow-xl">

    <h1 class="text-xl font-bold text-center flex items-center justify-center gap-2">
      ðŸ§© Daily Code Snippet
    </h1>

    <!-- FORM -->
    <div class="space-y-3">
      <input
        id="email"
        class="w-full p-2 rounded bg-slate-700 outline-none focus:ring-2 focus:ring-indigo-500"
        placeholder="Email"
        autocomplete="email"
      />

      <input
        id="password"
        type="password"
        class="w-full p-2 rounded bg-slate-700 outline-none focus:ring-2 focus:ring-indigo-500"
        placeholder="Password"
        autocomplete="current-password"
      />

      <div class="flex gap-2">
        <button
          onclick="login()"
          class="w-1/2 bg-indigo-600 hover:bg-indigo-700 p-2 rounded font-semibold transition"
        >
          Login
        </button>
        <button
          onclick="signup()"
          class="w-1/2 bg-green-600 hover:bg-green-700 p-2 rounded font-semibold transition"
        >
          Signup
        </button>
      </div>
    </div>

    <!-- DIVIDER -->
    <div class="relative flex py-2 items-center">
      <div class="flex-grow border-t border-slate-600"></div>
      <span class="mx-4 text-gray-400 text-sm">OR</span>
      <div class="flex-grow border-t border-slate-600"></div>
    </div>

    <!-- GOOGLE LOGIN -->
    <a
      href="http://127.0.0.1:8000/auth/google/login"
      class="w-full bg-white text-gray-900 border border-gray-300 hover:bg-gray-100 p-2 rounded flex items-center justify-center gap-2 font-semibold transition"
    >
      <img
        src="https://www.svgrepo.com/show/475656/google-color.svg"
        class="w-5 h-5"
        alt="Google Icon"
      />
      Sign in with Google
    </a>

    <hr class="border-slate-600" />

    <!-- GUEST -->
    <button
      onclick="continueAsGuest()"
      class="w-full bg-slate-600 hover:bg-slate-500 p-2 rounded transition"
    >
      Continue as Guest
    </button>
  </div>

  <script src="./auth.js"></script>

  <!-- âœ… Reveal UI ONLY after guards pass -->
  <script>
    document.body.style.visibility = "visible";
  </script>
</body>
</html>
